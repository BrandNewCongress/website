//     Stratus.Services.Tracking.js 1.0
!function(root,factory){"function"==typeof define&&define.amd?define(["stratus","underscore"],factory):factory(root.Stratus,root._)}(this,function(Stratus,_){Stratus.Services.Tracking=["$provide",function($provide){$provide.factory("tracking",function($document,$window){return function(){this.parseURL=function(url){var a=document.createElement("a");return a.href=url,a.hostname},this.getParameterByName=function(name,url){url||(url=window.location.href),name=name.replace(/[\[\]]/g,"\\$&");var regex=new RegExp("[?&]"+name+"(=([^&#]*)|&|#|$)"),results=regex.exec(url);return results?results[2]?decodeURIComponent(results[2].replace(/\+/g," ")):"":null},this.getUTMCode=function(name){var value=this.getParameterByName(name);return value||"utmSource"!=name||(value=this.parseURL(document.referrer)),value},this.getRefcode=function(){var utmCampaign=this.getUTMCode("utmCampaign"),utmSource=this.getUTMCode("utmSource"),utmMedium=this.getUTMCode("utmMedium");return(utmCampaign?utmCampaign+"/":"")+(utmSource?utmSource:"")+(utmMedium?"/"+utmMedium:"")},this.setRefcode=function(options){options=options?options:{},options.url=options.url?options.url:"https://secure.actblue.com";var links=document.querySelectorAll('[href^="'+options.url+'"]');if(links.length>0)for(var refCode=this.getRefcode(),index=0;index<links.length;index++){var link=links[index];link.href=link.href+"?refcode="+refCode}},this.send=function(category,action){return ga("send","event",category,action),!0}}})}]});